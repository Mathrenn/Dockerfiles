# Run brave in a singularity container
#
# singularity build --fakeroot --tmpdir=$SIFDIR $SIFDIR/brave.sif $DEFDIR/brave/brave.def
# singularity run --nv $SIFDIR/brave.sif
#

BootStrap: docker
From: debian:bullseye-slim

%post
    # Tell debconf to run in non-interactive mode
    export DEBIAN_FRONTEND=noninteractive
    
    apt-get update && apt-get install -y \
      apt-transport-https \
      ca-certificates \
      curl \
      gnupg \
      procps \
      libgconf-2-4 libappindicator1 \
      libgtk-3-0 libx11-xcb1 \
      apulse \
      --no-install-recommends

    curl -s https://brave-browser-apt-release.s3.brave.com/brave-core.asc | apt-key --keyring /etc/apt/trusted.gpg.d/brave-browser-release.gpg add -
    echo "deb [arch=amd64] https://brave-browser-apt-release.s3.brave.com/ stable main" | tee /etc/apt/sources.list.d/brave-browser-release.list
    apt update
    apt install -y brave-browser

%runscript
    # Start brave
    brave-browser
